FROM node:18-alpine

WORKDIR /app

# Remove old global npm and install the latest
RUN rm -rf /usr/local/lib/node_modules/npm \
    && npm install -g npm@10.9.0

COPY package*.json ./
RUN npm ci

COPY . .

EXPOSE 3000

CMD ["npm", "start"]